<!DOCTYPE html>
<html lang="zh">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeInWord</title>
    <meta name="keywords" content="CodeInWord,代码高亮,word,微软word高亮代码,word中美化代码">
    <meta name="description" content="生成可以在word中高亮的代码，支持各类主流语言，代码美化，代码高亮。">

    <!-- CSS 引入 -->
    <link rel="stylesheet" href="./src/styles.css">
    <link rel="stylesheet" href="./src/SyntaxHighlighter.css">

    <!-- JavaScript 引入 -->
    <script type="text/javascript" src="./src/jquery.min.js"></script>
    <script type="text/javascript" src="./src/shCore.js"></script>
    <script type="text/javascript" src="./src/shBrushCpp.js"></script>
    <script type="text/javascript" src="./src/shBrushCSharp.js"></script>
    <script type="text/javascript" src="./src/shBrushCss.js"></script>
    <script type="text/javascript" src="./src/shBrushDelphi.js"></script>
    <script type="text/javascript" src="./src/shBrushJava.js"></script>
    <script type="text/javascript" src="./src/shBrushJScript.js"></script>
    <script type="text/javascript" src="./src/shBrushPhp.js"></script>
    <script type="text/javascript" src="./src/shBrushPython.js"></script>
    <script type="text/javascript" src="./src/shBrushRuby.js"></script>
    <script type="text/javascript" src="./src/shBrushSql.js"></script>
    <script type="text/javascript" src="./src/shBrushVb.js"></script>
    <script type="text/javascript" src="./src/shBrushXml.js"></script>
</head>

<body>
    <div id="main">
        <!-- 语言选择和高亮按钮 -->
        <div id="select-box">
            <label id="select-label">选择语言：</label>
            <select id="languageSelected">
                <option value="c++">C, C++</option>
                <option value="c#">C#</option>
                <option value="css">CSS</option>
                <option value="delphi">Delphi, Pascal</option>
                <option value="xml">XML</option>
                <option value="java">Java</option>
                <option value="javascript">Javascript</option>
                <option value="php">PHP</option>
                <option value="python">Python</option>
                <option value="ruby">Ruby</option>
                <option value="sql">SQL</option>
                <option value="vb">VB</option>
                <option value="xml">HTML</option>
            </select>
            <button id="startExecute" onclick="formatcode()" class="tool-button">高亮</button>
        </div>
        <div id="input-box">
            <!-- 左侧代码输入区 -->
            <div id="left-box">
                <textarea id="srccode" placeholder="此处输入源码，选择语言后点击高亮按钮，右侧结果复制粘贴到 Word 文档中即可."></textarea>
            </div>

            <!-- 右侧代码显示区 -->
            <div id="right-container">
                <!-- 代码高亮显示区域 -->
                <div id="right-box">
                    <div id="formatcode">
                        <div class="dp-highlighter">
                            <div class="bar"></div>
                            <ol start="1" class="dp-cpp">
                                <li class="alt"><span><span>&nbsp;&nbsp;</span></span></li>
                            </ol>
                        </div><textarea name="code" id="code" class="c++" style="display: none;"></textarea>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function formatcode() {
            var srcCode = document.getElementById("srccode");
            var divA = document.getElementById("formatcode");
            var innerHtml = '<textarea name="code" id="code" class="' + $("#languageSelected").val() + '">';
            innerHtml = innerHtml + $("#srccode").val() + '</textarea>';
            divA.innerHTML = innerHtml;
            dp.SyntaxHighlighter.HighlightAll('code', true, false);
        }

        document.addEventListener('DOMContentLoaded', function () {
            // 初始化代码高亮
            var divA = document.getElementById("formatcode");
            var innerHtml = '<textarea name="code" id="code" class="c++">' + $("#srccode").val() + '</textarea>';
            divA.innerHTML = innerHtml;
            dp.SyntaxHighlighter.HighlightAll('code', true, false);
        });
    </script>
</body>

</html>